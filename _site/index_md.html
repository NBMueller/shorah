<h1 id='what_is_shorah'>What is ShoRAH</h1>

<p>ShoRAH is an open source project for the analysis of next generation sequencing data. It is designed to analyse genetically heterogeneous samples. Its tools are written in different programming languages and provide error correction, haplotype reconstruction and estimation of the frequency of the different genetic variants present in a mixed sample.</p>
<hr />
<p>The software suite ShoRAH (Short Reads Assembly into Haplotypes) consists of several programs, the most imporant of which are:</p>

<blockquote>
<p><code>amplian.py</code> - amplicon based analysis</p>
</blockquote>

<blockquote>
<p><code>dec.py</code> - local error correction based on diri_sampler</p>
</blockquote>

<blockquote>
<p><code>diri_sampler</code> - Gibbs sampling for error correction via Dirichlet process mixture</p>
</blockquote>

<blockquote>
<p><code>contain</code> - removal of redundant reads</p>
</blockquote>

<blockquote>
<p><code>mm.py</code> - maximum matching haplotype construction</p>
</blockquote>

<blockquote>
<p><code>freqEst</code> - EM algorithm for haplotype frequency</p>
</blockquote>

<blockquote>
<p><code>snv.py</code> - detects single nucleotide variants, taking strand bias into account</p>
</blockquote>

<blockquote>
<p><code>shorah.py</code> - wrapper for everything</p>
</blockquote>

<h2 id='citation'>Citation</h2>

<p>If you use shorah, please cite the application note paper <em>Zagordi et al.</em> on <a href='http://www.biomedcentral.com/1471-2105/12/119'>BMC Bioinformatics</a>.</p>

<h2 id='general_usage'>General usage</h2>

<h3 id='dependencies_and_installation'>Dependencies and installation</h3>

<p>Please download and install:</p>

<ul>
<li><a href='http://biopython.org/wiki/Download'>Biopython</a>, following the online instructions.</li>

<li><a href='http://www.gnu.org/software/gsl/'>GNU scientific library GSL</a>, installation is described in the included README and INSTALL files.</li>

<li>ncurses is required by samtools. It is usually included in Linux/Mac OS X.</li>
</ul>

<p>Please note that these dependencies can be satisfied also using the package manager of many operating system. For example <a href='http://www.macports.org/'>MacPorts</a> on Mac OS X, <a href='http://yum.baseurl.org/'>yum</a> on several linux installations and so on.</p>

<p>Type &#8216;make&#8217; to build the C++ programs. This should be enough in most cases. If your GSL installation is not standard, you might need to edit the relevant lines in the <code>Makefile</code> (location <code>/opt/local/</code> is already included).</p>

<h3 id='run'>Run</h3>

<p>The input is a sorted bam file. Analysis can be performed in local or global mode.</p>

<h4 id='local_analysis'><a href='local.html'>Local analysis</a></h4>

<p>The local analysis alone can be run invoking <code>dec.py</code> or <code>amplian.py</code> (program for the amplicon mode). They work by cutting window from the multiple sequence alignment, invoking <code>diri_sampler</code> on the windows and calling <code>snv.py</code> for the SNV calling.</p>

<h4 id='global_analysis'><a href='global.html'>Global analysis</a></h4>

<p>The whole global reconstruction consists of the following steps:</p>

<ol>
<li>error correction (<em>i.e.</em> local haplotype reconstruction);</li>

<li>SNV calling;</li>

<li>removal of redundant reads;</li>

<li>global haplotype reconstruction;</li>

<li>frequency estimation.</li>
</ol>

<p>These can be run one after the other, or one can invoke <code>shorah.py</code>, that runs the whole process from bam file to frequency estimation and SNV calling.</p>